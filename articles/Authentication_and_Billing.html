<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sevenbridges2">
<title>Authentication and Billing reference guide for Seven Bridges API R Client • sevenbridges2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Authentication and Billing reference guide for Seven Bridges API R Client">
<meta property="og:description" content="sevenbridges2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sevenbridges2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Authentication_and_Billing.html">Authentication and Billing reference guide for Seven Bridges API R Client</a>
    <a class="dropdown-item" href="../articles/Files_upload_and_Volumes.html">File upload and Volumes reference guide for Seven Bridges API R Client</a>
    <a class="dropdown-item" href="../articles/Projects_and_Tasks_execution.html">Projects, Files, Apps and Tasks execution with Seven Bridges API R Client</a>
    <a class="dropdown-item" href="../articles/quickstart.html">Introduction and Quickstart for Seven Bridges API R Client</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sbg/sevenbridges2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Authentication and Billing reference guide for Seven Bridges API R Client</h1>
            
            <h4 data-toc-skip class="date">2023-12-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbg/sevenbridges2/blob/HEAD/vignettes/Authentication_and_Billing.Rmd" class="external-link"><code>vignettes/Authentication_and_Billing.Rmd</code></a></small>
      <div class="d-none name"><code>Authentication_and_Billing.Rmd</code></div>
    </div>

    
    
<p><a name="top"></a></p>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>Before you can interact with the API, you need to construct an
<code>Auth</code> object which stores the following information:</p>
<ul>
<li>Your authentication token. This is used to authenticate your
credentials with the API. Learn more about obtaining your authentication
token on the <a href="https://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token" class="external-link">Seven
Bridges Platform</a>, <a href="http://docs.cancergenomicscloud.org/v1.0/docs/get-your-authentication-token" class="external-link">Cancer
Genomics Cloud (CGC)</a>, <a href="https://sb-biodatacatalyst.readme.io/docs/get-your-authentication-token#find-your-authentication-token" class="external-link">BioData
Catalyst (BDC)</a>, and <a href="https://docs.cavatica.org/docs/get-your-authentication-token#your-authentication-token" class="external-link">CAVATICA</a>.</li>
</ul>
<p>The approach for obtaining the authentication token also applies to
the other Seven Bridges platforms.</p>
<ul>
<li>The path for the API (base URL).</li>
<li>The name of the platform you are using. This is an optional field,
as the base URL of the API ultimately decides where the API calls will
be sent to. This field will only be blank when the URL was directly
provided, and the platform name could not be inferred from that
URL.</li>
</ul>
<p>The general authentication logic for <code>Auth$new()</code> is as
follows:</p>
<ol style="list-style-type: decimal">
<li>The package will use the direct authentication method if the
<code>from</code> parameter is not specified explicitly or is specified
as <code>from = "direct</code>.</li>
<li>The package will load the authentication information from
environment variables when <code>from = "env"</code>, or user
configuration file when <code>from = "file"</code>.</li>
</ol>
<div class="section level3">
<h3 id="direct-authentication">Direct authentication<a class="anchor" aria-label="anchor" href="#direct-authentication"></a>
</h3>
<p>To use direct authentication, users need to specify one of
<code>platform</code> or <code>url</code>, with the corresponding
<code>token</code>. Examples of direct authentication:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Direct authentication with setting platform parameter</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span>,</span>
<span>  platform <span class="op">=</span> <span class="st">"aws-us"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The above will use the Seven Bridges Platform on AWS (US).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Direct authentication with setting url parameter</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span>,</span>
<span>  url <span class="op">=</span> <span class="st">"https://api.sb.biodatacatalyst.nhlbi.nih.gov/v2/"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The above will use the specified <code>url</code> as the base URL for
the API calls. In this example, the <code>url</code> points to BioData
Catalyst powered by Seven Bridges.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Direct authentication on default aws-us platform</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span><span class="op">)</span></span></code></pre></div>
<p>The above will use the Seven Bridges Platform on AWS since neither
<code>platform</code> nor <code>url</code> were explicitly
specified.</p>
<p><strong><em>Note:</em></strong> <code>platform</code> and
<code>url</code> should not be specified at the same time.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level3">
<h3 id="authentication-via-system-environment-variables">Authentication via system environment variables<a class="anchor" aria-label="anchor" href="#authentication-via-system-environment-variables"></a>
</h3>
<p>The R API client supports reading authentication information stored
in system environment variables.</p>
<p>To set the two environment variables in your system, use the function
<code>sbg_set_env()</code>. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set environment variables</span></span>
<span><span class="fu">sevenbridges2</span><span class="fu">:::</span><span class="fu">sbg_set_env</span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://cgc-api.sbgenomics.com/v2"</span>,</span>
<span>  token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>See if the environment variables are correctly set:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check environment variables</span></span>
<span><span class="fu">sevenbridges2</span><span class="fu">:::</span><span class="fu">sbg_get_env</span><span class="op">(</span><span class="st">"SB_API_ENDPOINT"</span><span class="op">)</span></span>
<span><span class="co">## "https://cgc-api.sbgenomics.com/v2"</span></span>
<span></span>
<span><span class="fu">sevenbridges2</span><span class="fu">:::</span><span class="fu">sbg_get_env</span><span class="op">(</span><span class="st">"SB_AUTH_TOKEN"</span><span class="op">)</span></span>
<span><span class="co">## "&lt;your_token&gt;"</span></span></code></pre></div>
<p>Now you can create the <code>Auth</code> object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Authenticate using environment variables</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"env"</span><span class="op">)</span></span></code></pre></div>
<p>To unset the two environment variables:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Unset environment variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.unsetenv</a></span><span class="op">(</span><span class="st">"SB_API_ENDPOINT"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.unsetenv</a></span><span class="op">(</span><span class="st">"SB_AUTH_TOKEN"</span><span class="op">)</span></span></code></pre></div>
<p>If you need to be logged into multiple accounts at the same time it
is essential that you provide environment variables for each of the
accounts. Of course, these variables must have different names.</p>
<p>If you do not have pre-set environment variables, you can create them
in the following way:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set environment variables for the first account</span></span>
<span><span class="fu">sevenbridges2</span><span class="fu">:::</span><span class="fu">sbg_set_env</span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://api.sbgenomics.com/v2"</span>,</span>
<span>  token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span>,</span>
<span>  sysenv_url_name <span class="op">=</span> <span class="st">"account_1_url"</span>,</span>
<span>  sysenv_token_name <span class="op">=</span> <span class="st">"account_1_token"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set environment variables for the second account</span></span>
<span><span class="fu">sevenbridges2</span><span class="fu">:::</span><span class="fu">sbg_set_env</span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://api.sb.biodatacatalyst.nhlbi.nih.gov/v2/"</span>,</span>
<span>  token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span>,</span>
<span>  sysenv_url_name <span class="op">=</span> <span class="st">"account_2_url"</span>,</span>
<span>  sysenv_token_name <span class="op">=</span> <span class="st">"account_2_token"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now you are ready to create an authentication object for these two
accounts:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Authenticate using the first account</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">sevenbridges2</span><span class="fu">::</span><span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="st">"env"</span>,</span>
<span>  sysenv_url <span class="op">=</span> <span class="st">"account_1_url"</span>,</span>
<span>  sysenv_token <span class="op">=</span> <span class="st">"account_1_token"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Authenticate using the second account</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">sevenbridges2</span><span class="fu">::</span><span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="st">"env"</span>,</span>
<span>  sysenv_url <span class="op">=</span> <span class="st">"account_2_url"</span>,</span>
<span>  sysenv_token <span class="op">=</span> <span class="st">"account_2_token"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level3">
<h3 id="authentication-via-user-configuration-file">Authentication via user configuration file<a class="anchor" aria-label="anchor" href="#authentication-via-user-configuration-file"></a>
</h3>
<p>You can create an ini-like file named <code>credentials</code> under
the folder <code>$HOME/.sevenbridges/</code> and maintain your
credentials for multiple accounts across various Seven Bridges
environments. An example:</p>
<pre><code>[aws-us-rfranklin]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

# This is a comment:
# another user on the same platform
[aws-us-rosalind-franklin]
api_endpoint = https://api.sbgenomics.com/v2
auth_token = token_for_this_user

[default]
api_endpoint = https://cgc-api.sbgenomics.com/v2
auth_token = token_for_this_user

[bdc]
api_endpoint = https://api.sb.biodatacatalyst.nhlbi.nih.gov/v2/
auth_token = token_for_this_user</code></pre>
<p>Please make sure to have two fields named <strong>exactly</strong> as
<code>api_endpoint</code> and <code>auth_token</code> under each
profile.</p>
<p>To load the default profile (named <code>[default]</code>) from the
default user configuration file
(<code>$HOME/.sevenbridges/credentials</code>), please use:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Authenticate using file configuration</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"file"</span><span class="op">)</span></span></code></pre></div>
<p>To load the user profile <code>aws-us-&lt;username&gt;</code> from
this configuration file, change the <code>profile_name</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Authenticate using file configuration and specific profile</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>from <span class="op">=</span> <span class="st">"file"</span>, profile_name <span class="op">=</span> <span class="st">"aws-us-&lt;username&gt;"</span><span class="op">)</span></span></code></pre></div>
<p>To use a user configuration file from other locations (not
recommended), please specify the file path using the argument
<code>config_file</code>. For example:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Authenticate using specific file configuration on custom path</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="st">"file"</span>, config_file <span class="op">=</span> <span class="st">"~/sevenbridges.cfg"</span>,</span>
<span>  profile_name <span class="op">=</span> <span class="st">"aws-us-&lt;username&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong><em>Note:</em></strong> If you edited the
<code>credentials</code> file, please use <code>Auth$new()</code> to
re-authenticate.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div class="section level2">
<h2 id="api-general-information">API general information<a class="anchor" aria-label="anchor" href="#api-general-information"></a>
</h2>
<div class="section level3">
<h3 id="advance-access-features">Advance Access Features<a class="anchor" aria-label="anchor" href="#advance-access-features"></a>
</h3>
<p>Similar to <code>offset</code> and <code>limit</code>, every API call
accepts an argument named <code>advance_access</code>. This argument was
first introduced in August 2017 and controls if a special field in the
HTTP request header will be sent, which can enable access to the
“Advance Access” features in the Seven Bridges API.</p>
<p>In addition to modifying each API call that uses Advance Access
features, the option can also be set globally at the beginning of your
API script. This offers a one-button switch for users who want to
experiment with Advance Access features. The option is disabled by
default:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package and check advance access option</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://www.sevenbridges.com" class="external-link">"sevenbridges2"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sevenbridges2"</span><span class="op">)</span><span class="op">$</span><span class="va">advance_access</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>For example, if we try to use the Markers API to list markers
available on a BAM file with the <code>advance_access</code> option
disabled, it will return an error message:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Authenticate first</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Auth.html">Auth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>token <span class="op">=</span> <span class="st">"&lt;your_token&gt;"</span>, platform <span class="op">=</span> <span class="st">"aws-us"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try to send request to list markers</span></span>
<span><span class="va">req</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="fu">api</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"genome/markers?file={bam_file_id}"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"GET"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## !HTTP Status 400: Advance access feature needs X-SBG-Advance-Access: advance header.</span></span></code></pre>
<p>To enable the Advance Access features, one can use</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enable advance access option</span></span>
<span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sevenbridges2"</span><span class="op">)</span></span>
<span><span class="va">opt</span><span class="op">$</span><span class="va">advance_access</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>sevenbridges2 <span class="op">=</span> <span class="va">opt</span><span class="op">)</span></span></code></pre></div>
<p>at the beginning of their scripts. Let’s check if the option has been
enabled:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check advance_access option again</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sevenbridges2"</span><span class="op">)</span><span class="op">$</span><span class="va">advance_access</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Send the API call again:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Send request again to list markers</span></span>
<span><span class="va">req</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="fu">api</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"genome/markers?file={bam_file_id}"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"GET"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The information on the markers available on that BAM file will be
returned:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read content</span></span>
<span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/content.html" class="external-link">content</a></span><span class="op">(</span><span class="va">req</span><span class="op">)</span></span></code></pre></div>
<pre><code>$href
[1] "https://api.sbgenomics.com/v2/genome/markers?file={bam_file_id}&amp;offset=0&amp;limit=50"

$items
$items[[1]]
$items[[1]]$href
[1] "https://api.sbgenomics.com/v2/genome/markers/{bam_file_id}"

$items[[1]]$id
[1] "{bam_file_id}"

$items[[1]]$name
[1] "Marker Title"

$items[[2]]
$items[[2]]$href
[1] "https://api.sbgenomics.com/v2/genome/markers/{bam_file_id}"

$items[[2]]$id
[1] "{bam_file_id}"

$items[[2]]$name
[1] "Marker Title"

$links
list()</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level3">
<h3 id="query-parameter-fields">Query Parameter <code>fields</code><a class="anchor" aria-label="anchor" href="#query-parameter-fields"></a>
</h3>
<p>All API calls take the optional query parameter <code>fields</code>.
This parameter enables you to specify the fields you want to be returned
when listing resources (e.g., all your projects) or getting details of a
specific resource (e.g., a given project).</p>
<p>The <code>fields</code> parameter can be used in the following
ways:</p>
<ol style="list-style-type: decimal">
<li><p>No <code>fields</code> parameter specified: returns <strong>all
fields</strong> for each resource returned (TBD for Apps).</p></li>
<li><p>The <code>fields</code> parameter can be set to a list of fields:
for example, to return a field’s id, name and size for files in a
project, you may issue the call
<code>p$list_files(fields = c("id" ,"name", "size"))</code>.</p></li>
<li><p>The <code>fields</code> parameter can be used to exclude a
specific file: if you wish to omit a certain field from the response, do
so using the <code>fields</code> parameter with the prefix
<code>!</code>. For example, to get the details of a file without
listing its metadata, issue a call
<code>p$list_files(fields = "!metadata")</code> or to exclude multiple
fields <code>p$list_files(fields = c("!metadata", "!tags"))</code>. The
entire metadata and tags fields will be removed from the
response.</p></li>
<li><p>The <code>fields</code> parameter can be used to include or omit
certain nested fields, in the same way as listed in 2 and 3 above: for
example, you can use <code>metadata.sample_id</code> or
<code>origin.task</code> for files.</p></li>
<li><p>Negations and nesting can be combined freely, so, for example,
you can issue
<code>p$list_files(fields = c("id", "name", "size", "!metadata.library", "!origin"))</code>.</p></li>
</ol>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level3">
<h3 id="rate-limits">Rate Limits<a class="anchor" aria-label="anchor" href="#rate-limits"></a>
</h3>
<p>This call returns information about your current rate limit. This is
the number of API calls you can make in one hour.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get rate limit info</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">rate_limit</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>It shows information about the remaining number of API calls to make
in one hour, along with time when the rate limit resets, and the total
and remaining number of instances available to the user.</p>
<pre><code>── Rate limit ──────────────────────────────────────────────────────────────
• rate
  • limit: 1000
  • remaining: 998
  • reset: 2023-11-27 14:24:38 CET
• instance
  • limit: 25
  • remaining: 25</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level3">
<h3 id="general-api-error-handlers">General API error handlers<a class="anchor" aria-label="anchor" href="#general-api-error-handlers"></a>
</h3>
<p>We should also mention that there are 3 types of general API errors
that are handled by the client <code>sevenbridges2</code> package:</p>
<ul>
<li>
<strong>Rate limit sleeper</strong> which pauses the execution of
any API call if rate limit is breached. The execution will automatically
continue when the required break time expires,</li>
<li>
<strong>Maintenance sleeper</strong> which pauses the execution if
Seven Bridges API is under maintenance and</li>
<li>
<strong>General error sleeper</strong> which pauses the execution if
response status code is equal or larger than 500 (if some server error
occurred).</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="list-all-api-calls">List All API Calls<a class="anchor" aria-label="anchor" href="#list-all-api-calls"></a>
</h2>
<p>Users are able to preview all main resource paths that exist on the
public Seven Bridges API. If you do not pass any parameters to
<code><a href="../reference/api.html">api()</a></code> from the <code>Auth</code> object, it will list all
API calls. Any parameters you provide will be passed to the
<code><a href="../reference/api.html">api()</a></code> function, but you do not have to pass your input
token and path once more since the <code>Auth</code> object already
handles this information. The following call from the <code>Auth</code>
object will check the response as well.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all API paths</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">api</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level2">
<h2 id="users">Users<a class="anchor" aria-label="anchor" href="#users"></a>
</h2>
<p>This call will return a successful response of the currently
authenticated user, while if you have some advanced privileges as an
Enterprise user, you can fetch information about other users when
specifying their usernames.</p>
<p>If you did not provide a username, it will show your user
information.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Return your information</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">user</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Return user RFranklin's information</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">user</span><span class="op">(</span>username <span class="op">=</span> <span class="st">"RFranklin"</span><span class="op">)</span></span></code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level2">
<h2 id="billing-groups-and-invoices">Billing Groups and Invoices<a class="anchor" aria-label="anchor" href="#billing-groups-and-invoices"></a>
</h2>
<div class="section level3">
<h3 id="billing-groups">Billing groups<a class="anchor" aria-label="anchor" href="#billing-groups"></a>
</h3>
<p>Billing operations are grouped under the <code>Billing_groups</code>
R6 Resource class and from here you can query all billing groups or
fetch a single one by its id.</p>
<p>When you fetch a single billing group it will be an object of the
<code>Billing</code> class.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get specific billing group</span></span>
<span><span class="va">my_billing_group</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="va">billing_groups</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"&lt;billing_group_id&gt;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># You can still print the billing group info by calling the print method</span></span>
<span><span class="va">my_billing_group</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can also get detailed information for a specific billing group.
The following options are available to you:</p>
<ul>
<li>analysis breakdown</li>
<li>storage breakdown</li>
<li>egress breakdown.</li>
</ul>
<p>To get an analysis breakdown for a billing group which contains
information on both the tasks and Data Studio analyses, call:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get analysis breakdown</span></span>
<span><span class="va">my_billing_group</span><span class="op">$</span><span class="fu">analysis_breakdown</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To get storage breakdown for a billing group, call:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get storage breakdown</span></span>
<span><span class="va">my_billing_group</span><span class="op">$</span><span class="fu">storage_breakdown</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Finally, you may want to get egress breakdown for a billing
group:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get egress breakdown</span></span>
<span><span class="va">my_billing_group</span><span class="op">$</span><span class="fu">egress_breakdown</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If something changes in the billing group, you can refresh your
<code>Billing</code> object by reloading it with:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reload Billing objcet</span></span>
<span><span class="va">my_billing_group</span><span class="op">$</span><span class="fu">reload</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div class="section level3">
<h3 id="invoices">Invoices<a class="anchor" aria-label="anchor" href="#invoices"></a>
</h3>
<p>The same logic applies for the invoices - the operations available
for invoices are grouped under the <code>Invoices</code> class and from
here you can query or fetch a single invoice with resource operations
<code>query()</code> and <code><a href="https://rdrr.io/r/base/get.html" class="external-link">get()</a></code>.</p>
<p>Listing all invoices doesn’t require any arguments to set, while if
you would like to list invoices of specific billing group, set the
<code>billing_group</code> parameter to the desired value.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List invoices of specific billing group</span></span>
<span><span class="va">invoices_bg</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="va">invoices</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span>billing_group <span class="op">=</span> <span class="st">"&lt;billing_group_id&gt;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print invoices</span></span>
<span><span class="va">invoices_bg</span></span></code></pre></div>
<p>Keep in mind that the result is <code>Collection</code> object which
stores the returned items in the <code>items</code> field.</p>
<p>To retrieve information about a single invoice, including the costs
for analysis and storage, and the invoice period, you can use the
<code><a href="https://rdrr.io/r/base/get.html" class="external-link">get()</a></code> method with the id parameter set to the ID of the
invoice you are querying.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get specific invoice by ID</span></span>
<span><span class="va">invoice</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="va">invoices</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"&lt;invoice_id&gt;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print</span></span>
<span><span class="va">invoice</span></span></code></pre></div>
<pre><code>── Invoice info ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
• approval_date: 2022-02-01T00:00:00Z
• pending: FALSE
• invoice_id: &lt;your_invoice_id&gt;
• href: https://api.sbgenomics.com/v2/billing/invoices/&lt;your_invoice_id&gt;
• invoice_period
  • from: 2022-01-01T00:00:00Z
  • to: 2022-01-31T23:59:59Z
• analysis_costs
  • currency: USD
  • amount: 101.77
• storage_costs
  • currency: USD
  • amount: 256.11
• total
  • currency: USD
  • amount: 357.88</code></pre>
<p>If something changes, you can always refresh your local
<code>Invoice</code> object by reloading it with:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reload Invoice object</span></span>
<span><span class="va">invoice</span><span class="op">$</span><span class="fu">reload</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div class="section level2">
<h2 id="send-a-feedback-item">Send a feedback item<a class="anchor" aria-label="anchor" href="#send-a-feedback-item"></a>
</h2>
<p>Lastly, to send feedback to Velsera via the API, you can use the
<code>Auth</code> class method <code>send_feedback()</code>. There are
three feedback types available: <code>"idea"</code>,
<code>"thought"</code>, or <code>"problem"</code>. You can send one
feedback item per minute.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Send feedback</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">send_feedback</span><span class="op">(</span></span>
<span>  <span class="st">"This is a test for sending feedback via API. Please ignore this message."</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"thought"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marko Trifunovic, Vladimir Obucina, Marija Jovanovic, Seven Bridges Genomics Inc..</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
